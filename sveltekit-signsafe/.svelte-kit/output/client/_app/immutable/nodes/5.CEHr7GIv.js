import{t as w,a as _,c as _e}from"../chunks/D5yI2wqk.js";import{i as ee}from"../chunks/BumpSI4p.js";import{o as de}from"../chunks/DiJJycSe.js";import{p as J,c as a,r as t,s as o,t as q,T as Z,a as N,f as F,m as A,b,g as r,y as ce,ao as le}from"../chunks/MYc6eXHu.js";import{s as B,d as te}from"../chunks/Vyx9v3T8.js";import{i as $}from"../chunks/DWZY7GPS.js";import{d as W,b as E,c as ve,f as G,e as ue,i as ge,T as ye,t as O,l as Te}from"../chunks/BVR6nl7Y.js";import{f as fe,C as je,a as De,H as Ie,A as Ue,U as ze,E as Ce}from"../chunks/BS3JrhoZ.js";import{c as be,r as ne,b as he,s as Se}from"../chunks/Bv7EZ9Xw.js";import{p as ae}from"../chunks/H_26ShkY.js";var $e=w('<div class="flex w-full items-center justify-between"><div class="flex items-center gap-3"><div><!></div> <div><div class="font-medium"> </div> <div class="text-sm text-gray-500"> </div></div></div> <div> </div></div>');function we(m,s){J(s,!1);let e=ae(s,"item",8);function i(d){return new Date(d).toLocaleDateString("id-ID",{month:"long",day:"numeric",year:"numeric"})}ee();var l=$e(),n=a(l),c=a(n),g=a(c);{var x=d=>{je(d,{size:20})},k=d=>{De(d,{size:20})};$(g,d=>{e().type==="topup"||e().type==="receive"?d(x):d(k,!1)})}t(c);var f=o(c,2),T=a(f),h=a(T,!0);t(T);var p=o(T,2),j=a(p,!0);t(p),t(f),t(n);var D=o(n,2),U=a(D);t(D),t(l),q((d,C)=>{be(c,1,`flex h-8 w-8 items-center justify-center rounded-full
						${e().type==="topup"||e().type==="receive"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`),B(h,e().type==="topup"?"Top Up":e().type==="receive"?`Receive from ${e().sender_name??"unknown"}`:`Transfer to ${e().reciever_name??"unknown"}`),B(j,d),be(D,1,`text-right font-semibold 
					${e().type==="topup"||e().type==="receive"?"text-green-600":"text-red-600"}`),B(U,`${e().type==="transfer"?"-":"+"}${C??""}`)},[()=>i(e().timestamp),()=>fe(e().amount)],Z),_(m,l),N()}function xe(m,s){b(s,!r(s))}var Me=w('<p class="text-gray-500">Belum ada riwayat transaksi.</p>'),Re=w('<div class="bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black/70"><div class="w-full max-w-2xl rounded-xl bg-white p-6 shadow-lg"><h2 class="mb-4 text-xl font-semibold">Riwayat Transaksi</h2> <div class="flex max-h-[400px] flex-col gap-3 overflow-y-auto"><!></div> <div class="mt-4 flex justify-end"><button class="rounded bg-gray-200 px-4 py-2 text-gray-700 hover:bg-gray-300">Tutup</button></div></div></div>'),Ae=w('<button class="flex cursor-pointer flex-col items-center gap-2 rounded-xl bg-white p-4 shadow-sm transition-shadow duration-200 hover:shadow-md active:opacity-70"><div class="flex h-8 w-8 cursor-pointer items-center justify-center rounded-full bg-blue-100"><!></div> <span class="text-sm font-medium text-gray-700">Riwayat</span></button> <!>',1);function Be(m,s){J(s,!1);let e=A(!1),i=ae(s,"history",28,()=>[]);de(async()=>{try{const{data:f}=await W.get("/history");i(f)}catch(f){console.log(f)}}),ee();var l=Ae(),n=F(l);n.__click=[xe,e];var c=a(n),g=a(c);Ie(g,{size:16,strokeWidth:1.5,class:"text-blue-500"}),t(c),ce(2),t(n);var x=o(n,2);{var k=f=>{var T=Re(),h=a(T),p=o(a(h),2),j=a(p);{var D=v=>{var u=Me();_(v,u)},U=v=>{var u=_e(),S=F(u);ue(S,1,i,ge,(z,L)=>{we(z,{get item(){return r(L)}})}),_(v,u)};$(j,v=>{i().length===0?v(D):v(U,!1)})}t(p);var d=o(p,2),C=a(d);C.__click=[xe,e],t(d),t(h),t(T),E(3,h,()=>ve,()=>({duration:200})),E(3,T,()=>G,()=>({duration:75})),_(f,T)};$(x,f=>{r(e)&&f(k)})}_(m,l),N()}te(["click"]);async function Ee(m,s,e,i){if(!r(s)||r(e)<=0){O.error("Please select a user and enter a valid amount.");return}const l={to_user_id:r(s).id,amount:r(e)};try{const n=await W.post("/transfer",l);O.success(`Berhasil transfer ${fe(r(e))} ke ${r(s).name}`),window.location.reload()}catch(n){O.error("Gagal transfer coba lagi nanti"),console.log(n);return}b(i,!1)}var Le=(m,s)=>{b(s,!0)},Oe=w('<p class="mt-1 text-sm text-gray-500">Loading...</p>'),We=(m,s,e,i,l)=>{b(s,r(e)),b(i,[]),b(l,"")},He=w('<button class="cursor-pointer px-4 py-2 text-sm hover:bg-blue-100"><li> </li></button>'),Pe=w('<ul class="mt-1 max-h-40 overflow-y-auto rounded border border-gray-300 bg-white"></ul>'),qe=w('<p class="mt-2 text-sm text-green-600"> </p>'),Fe=(m,s)=>{b(s,!1)},Ge=w('<div class="fixed inset-0 z-40 flex items-center justify-center bg-black/70"><div class="z-50 w-[90%] max-w-md rounded-2xl bg-white p-6 shadow-lg"><h2 class="mb-4 text-xl font-semibold text-gray-800">Transfer Saldo</h2> <div class="mb-4"><label for="user" class="mb-1 block text-sm text-gray-600">Pilih User</label> <input type="text" class="w-full rounded-lg border border-gray-300 px-4 py-2 text-sm" id="user" placeholder="Cari user..."> <!> <!> <!></div> <div class="mb-4"><label for="amount" class="mb-1 block text-sm text-gray-600">Nominal Transfer (Rp)</label> <input type="number" min="0" id="amount" class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="nominal transfet"></div> <div class="flex justify-end gap-3"><button class="rounded-lg bg-gray-200 px-4 py-2 text-sm hover:bg-gray-300">Cancel</button> <button class="rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700">Submit</button></div></div></div>'),Je=w('<button class="flex cursor-pointer flex-col items-center gap-2 rounded-xl bg-white p-4 shadow-sm transition-shadow duration-200 hover:shadow-md active:opacity-70"><div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-100"><!></div> <span class="text-sm font-medium text-gray-700">Transfer</span></button> <!> <!>',1);function Ne(m,s){J(s,!1);let e=A(!1),i=A(null),l=A(0),n=A(""),c=A([]),g=A(!1),x,k=ae(s,"currentID",8,"");function f(v){const u=v.target;b(n,u.value),clearTimeout(x),x=setTimeout(()=>{r(n).length>0&&T(r(n))},300)}async function T(v){b(g,!0);try{const{data:u}=await W.get(`/users?name=${encodeURIComponent(v)}`),S=u.filter(z=>z.id!==k());b(c,S)}catch(u){console.error("Failed to fetch users",u)}finally{b(g,!1)}}ee();var h=Je(),p=F(h);p.__click=[Le,e];var j=a(p),D=a(j);Ue(D,{size:16,strokeWidth:1.5,class:"text-blue-500"}),t(j),ce(2),t(p);var U=o(p,2);{var d=v=>{var u=Ge(),S=a(u),z=o(a(S),2),L=o(a(z),2);L.__input=f;var K=o(L,2);{var Q=I=>{var R=Oe();_(I,R)};$(K,I=>{r(g)&&I(Q)})}var H=o(K,2);{var re=I=>{var R=Pe();ue(R,5,()=>r(c),P=>P.id,(P,me)=>{var Y=He();Y.__click=[We,i,me,c,n];var pe=a(Y),ke=a(pe,!0);t(pe),t(Y),q(()=>B(ke,r(me).name)),_(P,Y)}),t(R),_(I,R)};$(H,I=>{r(c).length>0&&I(re)})}var se=o(H,2);{var oe=I=>{var R=qe(),P=a(R);t(R),q(()=>B(P,`Terpilih: ${r(i).name??""}`)),_(I,R)};$(se,I=>{r(i)&&I(oe)})}t(z);var y=o(z,2),M=o(a(y),2);ne(M),t(y);var V=o(y,2),X=a(V);X.__click=[Fe,e];var ie=o(X,2);ie.__click=[Ee,i,l,e],t(V),t(S),t(u),he(M,()=>r(l),I=>b(l,I)),E(3,S,()=>ve,()=>({duration:200})),E(3,u,()=>G,()=>({duration:200})),_(v,u)};$(U,v=>{r(e)&&v(d)})}var C=o(U,2);ye(C,{}),_(m,h),N()}te(["click","input"]);const Ke=async(m,s,e)=>{if(!r(s)||r(s)<=0){O.error("Amount must be greater than 0");return}const i={user_id:e(),amount:r(s)};try{const l=await W.post("/topup",i);O.success("Berhasil melakukan topup"),window.location.reload()}catch(l){console.log(l),O.error("Terjadi kesalahan saat topup")}b(s,null)};var Qe=(m,s)=>b(s,!0),Ve=(m,s)=>{b(s,!1)},Xe=w('<div class=" fixed inset-0 z-40 flex items-center justify-center bg-black/70"><div class="z-50 w-[90%] max-w-md rounded-2xl bg-white p-6 shadow-lg"><h2 class="mb-4 text-xl font-semibold text-gray-800">Top Up Balance</h2> <div class="mb-4"><label for="userID" class="mb-1 block text-sm text-gray-600">User ID</label> <input type="text" class="w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-2 text-sm" id="userID" readonly=""></div> <div class="mb-4"><label for="amount" class="mb-1 block text-sm text-gray-600">Amount (Rp)</label> <input type="number" min="0" id="amount" class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Masukkan jumlah top up"></div> <div class="flex justify-end gap-3"><button class="rounded-lg bg-gray-200 px-4 py-2 text-sm hover:bg-gray-300">Cancel</button> <button class="rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700">Submit</button></div></div></div>'),Ye=w('<button class="flex cursor-pointer flex-col items-center gap-2 rounded-xl bg-white p-4 shadow-sm transition-shadow duration-200 hover:shadow-md active:opacity-70"><div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-100"><!></div> <span class="text-sm font-medium text-gray-700">Top Up</span></button> <!> <!>',1);function Ze(m,s){J(s,!0);let e=ae(s,"userID",7),i=le(!1),l=le(null);de(async()=>{try{e(await Te())}catch(h){console.error("Error fetching user info on client:",h)}});var n=Ye(),c=F(n);c.__click=[Qe,i];var g=a(c),x=a(g);ze(x,{size:16,strokeWidth:1.5,class:"text-blue-500"}),t(g),ce(2),t(c);var k=o(c,2);{var f=h=>{var p=Xe(),j=a(p),D=o(a(j),2),U=o(a(D),2);ne(U),t(D);var d=o(D,2),C=o(a(d),2);ne(C),t(d);var v=o(d,2),u=a(v);u.__click=[Ve,i];var S=o(u,2);S.__click=[Ke,l,e],t(v),t(j),t(p),q(()=>Se(U,e())),he(C,()=>r(l),z=>b(l,z)),E(3,j,()=>ve,()=>({duration:200})),E(3,p,()=>G,()=>({duration:200})),_(h,p)};$(k,h=>{r(i)&&h(f)})}var T=o(k,2);ye(T,{}),_(m,n),N()}te(["click"]);const et=async()=>{localStorage.clear(),window.location.reload()};var tt=w('<div class="absolute -right-0 -bottom-10 rounded bg-white px-5 py-2 shadow"><ul><button class="cursor-pointer"><li>Logout</li></button></ul></div>'),at=w('<div class="relative"><!> <!></div>');function rt(m){let s=le(!1);const e=()=>{b(s,!r(s))};var i=at(),l=a(i);Ce(l,{size:25,onclick:e,class:"cursor-pointer"});var n=o(l,2);{var c=g=>{var x=tt(),k=a(x),f=a(k);f.__click=[et],t(k),t(x),E(1,x,()=>G,()=>({duration:70})),E(2,x,()=>G,()=>({duration:70})),_(g,x)};$(n,g=>{r(s)&&g(c)})}t(i),_(m,i)}te(["click"]);var st=w('<p class="w-full text-center text-gray-500">Belum ada riwayat transaksi.</p>'),ot=w('<div class="min-h-screen bg-gray-50"><div class="mx-auto mb-4 flex max-w-md items-center justify-between rounded-lg bg-white p-4"><h1 class="text-center text-2xl font-bold text-blue-500">E-Wallet</h1> <!></div> <div class="mx-auto max-w-md px-2"><div class="mb-6 flex flex-col items-stretch justify-between rounded-2xl bg-gradient-to-br from-blue-400 to-blue-500 p-6 text-white shadow-lg"><div class="flex items-center justify-between"><div class="flex flex-col items-start justify-center"><p class="text-xs text-blue-100">Username</p> <p class="text-sm font-medium text-white"> </p></div> <div class="flex flex-col items-start justify-center"><p class="text-xs text-blue-100">User ID</p> <p class="text-sm font-medium text-white"> </p></div></div> <div><p class="text-sm font-medium text-blue-100">Saldo Sekarang</p> <h1 class="text-3xl font-bold"> </h1></div></div> <div class="mb-6 grid grid-cols-3 gap-4"><!> <!> <!></div> <div class="rounded-2xl bg-white p-6 shadow-sm"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-800">Aktivitas Terakhir</h2></div> <div class="flex w-full flex-col gap-4"><!></div></div></div></div>');function bt(m,s){J(s,!1);let e=A(),i=A([]);de(async()=>{try{const{data:y}=await W("/me"),{data:M}=await W("/history");b(e,y),b(i,M)}catch(y){console.log(y),console.error("Error fetching user info on client:",y)}finally{}}),ee();var l=ot(),n=a(l),c=o(a(n),2);rt(c),t(n);var g=o(n,2),x=a(g),k=a(x),f=a(k),T=o(a(f),2),h=a(T,!0);t(T),t(f);var p=o(f,2),j=o(a(p),2),D=a(j,!0);t(j),t(p),t(k);var U=o(k,2),d=o(a(U),2),C=a(d,!0);t(d),t(U),t(x);var v=o(x,2),u=a(v);const S=Z(()=>r(e)?r(e).id:"");Ze(u,{get userID(){return r(S)}});var z=o(u,2);const L=Z(()=>r(e)?r(e).id:"");Ne(z,{get currentID(){return r(L)}});var K=o(z,2);Be(K,{}),t(v);var Q=o(v,2),H=o(a(Q),2),re=a(H);{var se=y=>{var M=st();_(y,M)},oe=y=>{var M=_e(),V=F(M);ue(V,1,()=>r(i),ge,(X,ie)=>{we(X,{get item(){return r(ie)}})}),_(y,M)};$(re,y=>{!r(i)||r(i).length<=0?y(se):y(oe,!1)})}t(H),t(Q),t(g),t(l),q(y=>{B(h,r(e)?r(e).name:"-"),B(D,r(e)?r(e).id:"-"),B(C,y)},[()=>r(e)?fe(r(e).balance):0],Z),_(m,l),N()}export{bt as component};
