import{R as je}from"../chunks/CYgJF_JY.js";import{l as Q,b as O,g as Ue,f as J,h as De,j as $e,a as q,T as ge,c as le,t as H,e as de,i as xe}from"../chunks/BVR6nl7Y.js";import{t as k,a as w,c as _e}from"../chunks/D5yI2wqk.js";import{i as ae}from"../chunks/BumpSI4p.js";import{o as re}from"../chunks/DiJJycSe.js";import{p as G,a as L,c as a,s as o,g as s,ao as te,r as t,b as x,f as N,y as ce,t as F,m as z,T as ye}from"../chunks/MYc6eXHu.js";import{d as se,s as P}from"../chunks/Vyx9v3T8.js";import{i as I}from"../chunks/DWZY7GPS.js";import{E as Ce,c as Ee,U as Ie,A as Ae,f as ve,C as ze,a as Pe,H as Oe}from"../chunks/BS3JrhoZ.js";import{r as ne,s as Re,b as he,c as me}from"../chunks/Bv7EZ9Xw.js";import{p as we}from"../chunks/H_26ShkY.js";function Me(l,r){throw new je(l,r.toString())}new TextEncoder;const He=async()=>{const l=await Q();if(console.log(l),!l)throw Me(302,"/auth")},jt=Object.freeze(Object.defineProperty({__proto__:null,load:He},Symbol.toStringTag,{value:"Module"})),Ke=async()=>{Ue(),window.location.reload()};var Ge=k('<div class="absolute -right-0 -bottom-10 rounded bg-white px-5 py-2 shadow"><ul><button class="cursor-pointer"><li>Logout</li></button></ul></div>'),Le=k('<div class="relative"><!> <!></div>');function Be(l,r){G(r,!0);let e=te(!1);const n=()=>{x(e,!s(e))};var i=Le(),d=a(i);Ce(d,{size:25,onclick:n,class:"cursor-pointer"});var v=o(d,2);{var _=y=>{var p=Ge(),u=a(p),h=a(u);h.__click=[Ke],t(u),t(p),O(1,p,()=>J,()=>({duration:70})),O(2,p,()=>J,()=>({duration:70})),w(y,p)};I(v,y=>{s(e)&&y(_)})}t(i),w(l,i),L()}se(["click"]);async function We(l,r){const n=new TextEncoder().encode(r),i=await crypto.subtle.sign({name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},l,n);return btoa(String.fromCharCode(...new Uint8Array(i)))}async function K(l,r,e){const n=crypto.randomUUID(),i=new Date().toISOString(),d=e?Ee(e):"";await De();const v=await $e(),_=await Q(),y=await crypto.subtle.importKey("jwk",v,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["sign"]),p=`${_}|${i}|${n}|${d}`,u=await We(y,p);console.log(p);const f={headers:{"X-UserID":_,"X-Nonce":n,"X-Timestamp":i,"X-Signature":u,"Content-Type":"application/json"}};let c;switch(l.toUpperCase()){case"GET":c=await q.get(r,f);break;case"POST":c=await q.post(r,e,f);break;case"PUT":c=await q.put(r,e,f);break;case"DELETE":c=await q.delete(r,{...f,data:e});break;case"PATCH":c=await q.patch(r,e,f);break;default:throw new Error(`Unsupported HTTP method: ${l}`)}return c.data}const Xe=async(l,r,e)=>{if(!s(r)||s(r)<=0){H.error("Amount must be greater than 0");return}const n={user_id:s(e),amount:s(r)};try{const i=await K("POST","/topup",n);H.success("Berhasil melakukan topup"),window.location.reload()}catch(i){console.log(i),H.error("Terjadi kesalahan saat topup")}x(r,null)};var qe=(l,r)=>x(r,!0),Je=(l,r)=>{x(r,!1)},Ne=k('<div class=" fixed inset-0 z-40 flex items-center justify-center bg-black/70"><div class="z-50 w-[90%] max-w-md rounded-2xl bg-white p-6 shadow-lg"><h2 class="mb-4 text-xl font-semibold text-gray-800">Top Up Balance</h2> <div class="mb-4"><label for="userID" class="mb-1 block text-sm text-gray-600">User ID</label> <input type="text" class="w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-2 text-sm" id="userID" readonly=""></div> <div class="mb-4"><label for="amount" class="mb-1 block text-sm text-gray-600">Amount (Rp)</label> <input type="number" min="0" id="amount" class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Masukkan jumlah top up"></div> <div class="flex justify-end gap-3"><button class="rounded-lg bg-gray-200 px-4 py-2 text-sm hover:bg-gray-300">Cancel</button> <button class="rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700">Submit</button></div></div></div>'),Fe=k('<button class="flex cursor-pointer flex-col items-center gap-2 rounded-xl bg-white p-4 shadow-sm transition-shadow duration-200 hover:shadow-md active:opacity-70"><div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-100"><!></div> <span class="text-sm font-medium text-gray-700">Top Up</span></button> <!> <!>',1);function Qe(l,r){G(r,!0);let e=te(""),n=te(!1),i=te(null);re(async()=>{try{x(e,await Q(),!0)}catch(f){console.error("Error fetching user info on client:",f)}});var d=Fe(),v=N(d);v.__click=[qe,n];var _=a(v),y=a(_);Ie(y,{size:16,strokeWidth:1.5,class:"text-blue-500"}),t(_),ce(2),t(v);var p=o(v,2);{var u=f=>{var c=Ne(),S=a(c),j=o(a(S),2),D=o(a(j),2);ne(D),t(j);var m=o(j,2),C=o(a(m),2);ne(C),t(m);var b=o(m,2),g=a(b);g.__click=[Je,n];var $=o(g,2);$.__click=[Xe,i,e],t(b),t(S),t(c),F(()=>Re(D,s(e))),he(C,()=>s(i),E=>x(i,E)),O(3,S,()=>le,()=>({duration:200})),O(3,c,()=>J,()=>({duration:200})),w(f,c)};I(p,f=>{s(n)&&f(u)})}var h=o(p,2);ge(h,{}),w(l,d),L()}se(["click"]);async function Ve(l,r,e,n){if(!s(r)||s(e)<=0){H.error("Please select a user and enter a valid amount.");return}const i={to_user_id:s(r).id,amount:s(e)};try{const d=await K("POST","/transfer",i);H.success(`Berhasil transfer ${ve(s(e))} ke ${s(r).name}`),window.location.reload()}catch(d){H.error("Gagal transfer coba lagi nanti"),console.log(d);return}x(n,!1)}var Ye=(l,r)=>{x(r,!0)},Ze=k('<p class="mt-1 text-sm text-gray-500">Loading...</p>'),et=(l,r,e,n,i)=>{x(r,s(e)),x(n,[]),x(i,"")},tt=k('<button class="cursor-pointer px-4 py-2 text-sm hover:bg-blue-100"><li> </li></button>'),at=k('<ul class="mt-1 max-h-40 overflow-y-auto rounded border border-gray-300 bg-white"></ul>'),rt=k('<p class="mt-2 text-sm text-green-600"> </p>'),st=(l,r)=>{x(r,!1)},ot=k('<div class="fixed inset-0 z-40 flex items-center justify-center bg-black/70"><div class="z-50 w-[90%] max-w-md rounded-2xl bg-white p-6 shadow-lg"><h2 class="mb-4 text-xl font-semibold text-gray-800">Transfer Saldo</h2> <div class="mb-4"><label for="user" class="mb-1 block text-sm text-gray-600">Pilih User</label> <input type="text" class="w-full rounded-lg border border-gray-300 px-4 py-2 text-sm" id="user" placeholder="Cari user..."> <!> <!> <!></div> <div class="mb-4"><label for="amount" class="mb-1 block text-sm text-gray-600">Nominal Transfer (Rp)</label> <input type="number" min="0" id="amount" class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="nominal transfet"></div> <div class="flex justify-end gap-3"><button class="rounded-lg bg-gray-200 px-4 py-2 text-sm hover:bg-gray-300">Cancel</button> <button class="rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700">Submit</button></div></div></div>'),it=k('<button class="flex cursor-pointer flex-col items-center gap-2 rounded-xl bg-white p-4 shadow-sm transition-shadow duration-200 hover:shadow-md active:opacity-70"><div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-100"><!></div> <span class="text-sm font-medium text-gray-700">Transfer</span></button> <!> <!>',1);function nt(l,r){G(r,!1);let e=z(!1),n=z(null),i=z(0),d=z(""),v=z([]),_=z(!1),y,p;re(async()=>{p=await Q()});function u(b){const g=b.target;x(d,g.value),clearTimeout(y),y=setTimeout(()=>{s(d).length>0&&h(s(d))},300)}async function h(b){x(_,!0);try{const $=(await K("GET",`/users?name=${encodeURIComponent(b)}`)).filter(E=>E.id!==p);x(v,$)}catch(g){console.error("Failed to fetch users",g)}finally{x(_,!1)}}ae();var f=it(),c=N(f);c.__click=[Ye,e];var S=a(c),j=a(S);Ae(j,{size:16,strokeWidth:1.5,class:"text-blue-500"}),t(S),ce(2),t(c);var D=o(c,2);{var m=b=>{var g=ot(),$=a(g),E=o(a($),2),R=o(a(E),2);R.__input=u;var B=o(R,2);{var oe=U=>{var A=Ze();w(U,A)};I(B,U=>{s(_)&&U(oe)})}var V=o(B,2);{var ie=U=>{var A=at();de(A,5,()=>s(v),X=>X.id,(X,pe)=>{var ee=tt();ee.__click=[et,n,pe,v,d];var fe=a(ee),Se=a(fe,!0);t(fe),t(ee),F(()=>P(Se,s(pe).name)),w(X,ee)}),t(A),w(U,A)};I(V,U=>{s(v).length>0&&U(ie)})}var T=o(V,2);{var M=U=>{var A=rt(),X=a(A);t(A),F(()=>P(X,`Terpilih: ${s(n).name??""}`)),w(U,A)};I(T,U=>{s(n)&&U(M)})}t(E);var W=o(E,2),Y=o(a(W),2);ne(Y),t(W);var Z=o(W,2),ue=a(Z);ue.__click=[st,e];var Te=o(ue,2);Te.__click=[Ve,n,i,e],t(Z),t($),t(g),he(Y,()=>s(i),U=>x(i,U)),O(3,$,()=>le,()=>({duration:200})),O(3,g,()=>J,()=>({duration:200})),w(b,g)};I(D,b=>{s(e)&&b(m)})}var C=o(D,2);ge(C,{}),w(l,f),L()}se(["click","input"]);var lt=k('<div class="flex w-full items-center justify-between"><div class="flex items-center gap-3"><div><!></div> <div><div class="font-medium"> </div> <div class="text-sm text-gray-500"> </div></div></div> <div> </div></div>');function ke(l,r){G(r,!1);let e=we(r,"item",8);function n(m){return new Date(m).toLocaleDateString("id-ID",{month:"long",day:"numeric",year:"numeric"})}ae();var i=lt(),d=a(i),v=a(d),_=a(v);{var y=m=>{ze(m,{size:20})},p=m=>{Pe(m,{size:20})};I(_,m=>{e().type==="topup"||e().type==="receive"?m(y):m(p,!1)})}t(v);var u=o(v,2),h=a(u),f=a(h,!0);t(h);var c=o(h,2),S=a(c,!0);t(c),t(u),t(d);var j=o(d,2),D=a(j);t(j),t(i),F((m,C)=>{me(v,1,`flex h-8 w-8 items-center justify-center rounded-full
						${e().type==="topup"||e().type==="receive"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`),P(f,e().type==="topup"?"Top Up":e().type==="receive"?`Receive from ${e().sender_name??"unknown"}`:`Transfer to ${e().reciever_name??"unknown"}`),P(S,m),me(j,1,`text-right font-semibold 
					${e().type==="topup"||e().type==="receive"?"text-green-600":"text-red-600"}`),P(D,`${e().type==="transfer"?"-":"+"}${C??""}`)},[()=>n(e().timestamp),()=>ve(e().amount)],ye),w(l,i),L()}function be(l,r){x(r,!s(r))}var dt=k('<p class="text-gray-500">Belum ada riwayat transaksi.</p>'),ct=k('<div class="bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black/70"><div class="w-full max-w-2xl rounded-xl bg-white p-6 shadow-lg"><h2 class="mb-4 text-xl font-semibold">Riwayat Transaksi</h2> <div class="flex max-h-[400px] flex-col gap-3 overflow-y-auto"><!></div> <div class="mt-4 flex justify-end"><button class="rounded bg-gray-200 px-4 py-2 text-gray-700 hover:bg-gray-300">Tutup</button></div></div></div>'),vt=k('<button class="flex cursor-pointer flex-col items-center gap-2 rounded-xl bg-white p-4 shadow-sm transition-shadow duration-200 hover:shadow-md active:opacity-70"><div class="flex h-8 w-8 cursor-pointer items-center justify-center rounded-full bg-blue-100"><!></div> <span class="text-sm font-medium text-gray-700">Riwayat</span></button> <!>',1);function ut(l,r){G(r,!1);let e=z(!1),n=we(r,"history",28,()=>[]);re(async()=>{try{const u=await K("GET","/history");n(u)}catch(u){console.log(u)}}),ae();var i=vt(),d=N(i);d.__click=[be,e];var v=a(d),_=a(v);Oe(_,{size:16,strokeWidth:1.5,class:"text-blue-500"}),t(v),ce(2),t(d);var y=o(d,2);{var p=u=>{var h=ct(),f=a(h),c=o(a(f),2),S=a(c);{var j=b=>{var g=dt();w(b,g)},D=b=>{var g=_e(),$=N(g);de($,1,n,xe,(E,R)=>{ke(E,{get item(){return s(R)}})}),w(b,g)};I(S,b=>{n().length===0?b(j):b(D,!1)})}t(c);var m=o(c,2),C=a(m);C.__click=[be,e],t(m),t(f),t(h),O(3,f,()=>le,()=>({duration:200})),O(3,h,()=>J,()=>({duration:75})),w(u,h)};I(y,u=>{s(e)&&u(p)})}w(l,i),L()}se(["click"]);var pt=k('<p class="w-full text-center text-gray-500">Belum ada riwayat transaksi.</p>'),ft=k('<div class="min-h-screen bg-gray-50"><div class="mx-auto mb-4 flex max-w-md items-center justify-between rounded-lg bg-white p-4"><h1 class="text-center text-2xl font-bold text-blue-500">E-Wallet</h1> <!></div> <div class="mx-auto max-w-md px-2"><div class="mb-6 flex flex-col items-stretch justify-between rounded-2xl bg-gradient-to-br from-blue-400 to-blue-500 p-6 text-white shadow-lg"><div class="flex items-center justify-between"><div class="flex flex-col items-start justify-center"><p class="text-xs text-blue-100">Username</p> <p class="text-sm font-medium text-white"> </p></div> <div class="flex flex-col items-start justify-center"><p class="text-xs text-blue-100">User ID</p> <p class="text-sm font-medium text-white"> </p></div></div> <div><p class="text-sm font-medium text-blue-100">Saldo Sekarang</p> <h1 class="text-3xl font-bold"> </h1></div></div> <div class="mb-6 grid grid-cols-3 gap-4"><!> <!> <!></div> <div class="rounded-2xl bg-white p-6 shadow-sm"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-800">Aktivitas Terakhir</h2></div> <div class="flex w-full flex-col gap-4"><!></div></div></div></div>');function Ut(l,r){G(r,!1);let e=z(),n=z([]);re(async()=>{try{const T=await Q();x(n,await K("GET","/history?limit=3")),x(e,await K("GET",`/users/${T}`)),console.log(s(n))}catch(T){console.error("Error fetching user info on client:",T)}finally{}}),ae();var i=ft(),d=a(i),v=o(a(d),2);Be(v,{}),t(d);var _=o(d,2),y=a(_),p=a(y),u=a(p),h=o(a(u),2),f=a(h,!0);t(h),t(u);var c=o(u,2),S=o(a(c),2),j=a(S,!0);t(S),t(c),t(p);var D=o(p,2),m=o(a(D),2),C=a(m,!0);t(m),t(D),t(y);var b=o(y,2),g=a(b);Qe(g,{});var $=o(g,2);nt($,{});var E=o($,2);ut(E,{}),t(b);var R=o(b,2),B=o(a(R),2),oe=a(B);{var V=T=>{var M=pt();w(T,M)},ie=T=>{var M=_e(),W=N(M);de(W,1,()=>s(n),xe,(Y,Z)=>{ke(Y,{get item(){return s(Z)}})}),w(T,M)};I(oe,T=>{!s(n)||s(n).length<=0?T(V):T(ie,!1)})}t(B),t(R),t(_),t(i),F(T=>{P(f,s(e)?s(e).name:"-"),P(j,s(e)?s(e).id:"-"),P(C,T)},[()=>s(e)?ve(s(e).balance):0],ye),w(l,i),L()}export{Ut as component,jt as universal};
